<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_ui_action">
    <sys_ui_action action="INSERT_OR_UPDATE">
        <action_name/>
        <active>true</active>
        <client>false</client>
        <client_script_v2><![CDATA[function onClick(g_form) {

}]]></client_script_v2>
        <comments/>
        <condition>new sn_nowassist_admin.NowAssistSkillConfig().isSkillConfigurationActive('42775d3993e456108b8674121bba103d')</condition>
        <form_action>true</form_action>
        <form_button>true</form_button>
        <form_button_v2>true</form_button_v2>
        <form_context_menu>false</form_context_menu>
        <form_link>false</form_link>
        <form_menu_button_v2>true</form_menu_button_v2>
        <form_style/>
        <format_for_configurable_workspace>false</format_for_configurable_workspace>
        <hint/>
        <isolate_script>false</isolate_script>
        <list_action>false</list_action>
        <list_banner_button>false</list_banner_button>
        <list_button>false</list_button>
        <list_choice>false</list_choice>
        <list_context_menu>false</list_context_menu>
        <list_link>false</list_link>
        <list_save_with_form_button>false</list_save_with_form_button>
        <list_style/>
        <messages/>
        <name>Call User</name>
        <onclick/>
        <order>100</order>
        <script><![CDATA[var inputsPayload = {};
// incident is a input of type: glide_record
inputsPayload['incident'] = {
    tableName: 'incident',
    sysId: current.getValue('sys_id'),
    queryString: ''
};

var request = {
    executionRequests: [{
        payload: inputsPayload,
        capabilityId: '3977993993e456108b8674121bba1070',
        meta: {
            skillConfigId: '42775d3993e456108b8674121bba103d'
        }
    }],
    mode: 'sync'
};

try {
    var getSentiment = sn_one_extend.OneExtendUtil.execute(request);
    var explanation = JSON.parse(getSentiment.capabilities['3977993993e456108b8674121bba1070'].response).model_output;
	explanation=explanation.replaceAll("**","<br></br>");
//	explanation=explanation.replace(/\n/g, '<br></br>');
		explanation=explanation.replace("Issue:","<b>Issue:</b>");
	explanation=explanation.replace("Business Impact:","<b>Business Impact:</b>");
	explanation=explanation.replace("Key Actions Taken:","<b>Key Actions Taken:</b>");
	explanation=explanation.replace("Resolution:","<b>Resolution:</b>");
	explanation=explanation.replace("Preventive Measures:","<b>Preventive Measures:</b>");
	explanation1=explanation.substring(0,explanation.indexOf("<b>Resolution"));
	explanation2=explanation.substring(explanation.indexOf("<b>Resolution"),explanation.indexOf("<b>Preventive Measures"));
	explanation3=explanation.substring(explanation.indexOf("<b>Preventive Measures"),explanation.length);
	explanation2=explanation2.replace(/\n/g, '<p></p>');
	explanation3=explanation3.replace("2.","<br></br>2.");
	explanation=explanation1+"<br></br><br></br>"+explanation2+explanation3;
	 current.work_notes = 'Please find below PIR Analysis:\n\n' + "[code]"+explanation + "[/code]"+"\n**[Auto-generated by Now Assist]";

    // explanation = explanation.replace("Issue:", "<strong>Issue:</strong>");
	// explanation=explanation.replace("Key Actions Taken:","<strong>Key Actions Taken:</strong>");
	// explanation=explanation.replace("Business Impact:","<strong>Business Impact:</strong>");
	// explanation=explanation.replace("Resolution:","<strong>Resolution:</strong>");
    // attach pdf to ticket
//   var pageSize = new sn_pdfgeneratorutils.PdfPage("A4", "LANDSCAPE");
    var document = new sn_pdfgeneratorutils.PDFGenerationAPI;
//    var fontColor = new sn_pdfgeneratorutils.Color([0.5, 0.0, 0.5]);

    //Margins
    var margins = 10.0;
    // declare image using sys attachment
    //  var image = new sn_pdfgeneratorutils.Image("a8c4627d1bac2910b73d84c4604bcb7f");
    //  image.scaleAbsolute(80, 50);
    //  document.addImage(image);
explanation ="<h3 style='text-align:center; font-size:25; color:#800080;'>PIR Report of Major Incident</h3>"+explanation;
    // Create a style for your paragraph
    // var paraStyle = new sn_pdfgeneratorutils.Style();
    //  paraStyle.setFontColor(fontColor);
    //  paraStyle.setFontSize(25);

    // paraStyle.setTextAlignment("text-center");
    // paraStyle.setBold();

    //  var myPara = new sn_pdfgeneratorutils.Paragraph("PIR Report of Major Incident");
    // //  myPara.setMargin(margins);
    //  myPara.addStyle(paraStyle);


    // document.addParagraph(myPara);

    // var myPara = new sn_pdfgeneratorutils.Paragraph(explanation);
    // myPara.addNewLine();
    // document.addParagraph(myPara);
    // myPara.addNewLine();
    // document.saveAsAttachment("incident", current.getUniqueValue(), "PIR_" + current.number + ".pdf");
	document.convertToPDF(explanation, "incident", current.getUniqueValue(), "PIR Report");

    current.update();

} catch (e) {
    gs.error(e);
    gs.addErrorMessage('Something went wrong while executing skill.');
}
action.setRedirectURL(current);]]></script>
        <show_insert>true</show_insert>
        <show_multiple_update>false</show_multiple_update>
        <show_query>false</show_query>
        <show_update>true</show_update>
        <sys_class_name>sys_ui_action</sys_class_name>
        <sys_created_by>vinitha</sys_created_by>
        <sys_created_on>2024-10-10 13:37:04</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>3881335793851e108b8674121bba1088</sys_id>
        <sys_mod_count>33</sys_mod_count>
        <sys_name>Call User</sys_name>
        <sys_overrides/>
        <sys_package display_value="underwriter.ai" source="x_ltin2_uw_ai">5365c533935496d08b8674121bba10e7</sys_package>
        <sys_policy/>
        <sys_scope display_value="underwriter.ai">5365c533935496d08b8674121bba10e7</sys_scope>
        <sys_update_name>sys_ui_action_3881335793851e108b8674121bba1088</sys_update_name>
        <sys_updated_by>vinitha</sys_updated_by>
        <sys_updated_on>2025-03-14 16:27:42</sys_updated_on>
        <table>incident</table>
        <ui11_compatible>true</ui11_compatible>
        <ui16_compatible>false</ui16_compatible>
    </sys_ui_action>
    <sys_es_latest_script action="INSERT_OR_UPDATE">
        <id>3881335793851e108b8674121bba1088</id>
        <sys_created_by>vinitha</sys_created_by>
        <sys_created_on>2024-10-10 14:19:07</sys_created_on>
        <sys_id>492b379793c51e108b8674121bba106c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>vinitha</sys_updated_by>
        <sys_updated_on>2024-10-10 14:19:07</sys_updated_on>
        <table>sys_ui_action</table>
        <use_es_latest>true</use_es_latest>
    </sys_es_latest_script>
</record_update>
